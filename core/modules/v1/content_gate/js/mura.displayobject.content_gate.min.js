Mura.preInit(function(){Mura.DisplayObject.Content_gate=Mura.UI.extend({}),Mura.DisplayObject.Content_gate.reopenClass({createStore:function(){var t={};return{set:function(e,a){return t[e]=a,this},get:function(e){return void 0!==t[e]?t[e]:null},getAll:function(e){return t}}}}),Mura.DisplayObject.Content_gate.reopen({render:function(){var t=this;this.context.scroll=parseInt(this.context.scroll)||0,this.context.delay=parseInt(this.context.delay)||0,this.context.displays=parseInt(this.context.displays)||0,this.context.visits=parseInt(this.context.visits)||0,this.context.resetinterval=this.context.resetinterval||"session",this.context.resetqty=parseInt(this.context.resetqty)||1,this.context.assetlabel=this.context.assetlabel||"",this.context.type=this.context.type||"modal",this.context.animatespeed=this.context.animatespeed||"fast",this.context.anchorx=this.context.anchorx||"center",this.context.anchory=this.context.anchory||"center",this.context.animate=this.context.animate||"",this.context.animatespeed=this.context.animatespeed||"fast",this.context.hideengaged=parseInt(this.context.hideengaged)||0,this.context.followupurl=this.context.followupurl||"",this.context.width=this.context.width||"md",this.context.cssclass=this.context.cssclass||"",this.context.instanceclass=this.context.instanceclass||"","modal"==this.context.type?(this.context.anchorx="center",this.context.anchory="center",this.context.animate||(this.context.animate="ttb")):"bar"==this.context.type?(this.context.anchorx="center",this.context.anchory="bottom",this.context.animate="btt"):"drawer"==this.context.type?("center"==this.context.anchorx&&(this.context.anchorx="right"),"right"==this.context.anchorx?this.context.animate="rtl":this.context.animate="ltr"):"inline"==this.context.type&&(this.context.width="full",this.context.animate="",this.context.animatespeed=""),Mura.isNumeric(this.context.scroll)||(this.context.scroll=0),Mura.isNumeric(this.context.delay)||(this.context.delay=0),Mura.isNumeric(this.context.displays)||(this.context.displays=0),Mura.isNumeric(this.context.visits)||(this.context.visits=0),Mura.isNumeric(this.context.resetqty)||(this.context.resetqty=1);var e=Mura.DisplayObject.Content_gate;void 0===e.store&&(e.store=e.createStore()),e.store.get(t.context.instanceid)||e.store.set(t.context.instanceid,e.createStore());var a=Mura.createUUID(),s=e.store.get(t.context.instanceid);s.set("executionid",a),Mura("body").on("click",t.context.selector+", .mxp-gated-link",function(n){if(Mura('div[data-instanceid="'+t.context.instanceid+'"]').length&&a==s.get("executionid")){var r=Mura(n.target);if(r.hasAttr("href")||(r=r.closest("a")),!(Mura.user.known&&"0"!=Mura.user.known||r.hasClass("mxp-open-gate"))){n.preventDefault(),n.stopPropagation();var o=Mura('div[data-instanceid="'+a+'"]'),i=!1;function c(){i=!0,o.length?Mura.processMarkup(o,!1,!0):Mura("body").appendDisplayObject({object:"cta",objectid:t.context.formid,instanceid:a,formid:t.context.formid,render:"client",type:t.context.type,scroll:t.context.scroll,delay:t.context.delay,displays:t.context.displays,visits:t.context.visits,resetinterval:t.context.resetinterval,resetqty:t.context.resetqty,animatespeed:t.context.animatespeed,anchorx:t.context.anchorx,anchory:t.context.anchory,animate:t.context.animate,animatespeed:t.context.animatespeed,width:t.context.width,cssclass:t.context.cssclass,instanceclass:context.context.instanceclass,queue:!1,followupurl:r.attr("href"),hideengaged:t.context.hideengaged})}if(r.hasAttr("href"))if(e.store.set("gated_href",r.attr("href")),t.context.assetlabel&&(e.store.set("gated_href_label",t.context.assetlabel),c()),r.hasAttr("label"))e.store.set("gated_href_label",r.attr("label")),c();else if(r.hasAttr("data-label"))e.store.set("gated_href_label",r.attr("data-label")),c();else if(!i){var h=r.attr("href").split("?");(h=h[0].split("/")).reverse();var l="";for(var d in h)if(h[d]){l=h[d];break}l?Mura.getEntity("content").loadBy("urltitle",l).then(function(t){t.exists()?e.store.set("gated_href_label",t.get("menutitle")):e.store.set("gated_href_label",r.html()),c()}).catch(function(){e.store.set("gated_href_label",r.html()),c()}):(e.store.set("gated_href_label",r.html()),c())}}}}),Mura.loader().load(Mura.corepath+"/modules/v1/cta/css/mura-cta-config.css");var n=Mura(this.context.targetEl).closest(".mura-region-local");n.length&&n.data("perm")&&Mura(this.context.targetEl).html('<div class="mura-cta-empty" data-mura-cta-type-label="gate"></div>');var r=Mura(t.context.targetEl).closest(".mura-object");r.hide(),setTimeout(function(){r.show()},20)}}),Mura.DisplayObject.Form.reopen({onAfterResponseRender:function(){this.parseGateTokens()},onAfterRender:function(){this.parseGateTokens()},parseGateTokens:function(){var t=Mura(this.context.targetEl),e=Mura.DisplayObject.Content_gate;e.store?t.find("div.mura-form-text, div.mura-response-success").each(function(){var t=Mura(this),a=t.html();e.store.get("gated_href")?a=a.replace("${gated_href}",e.store.get("gated_href")):gated_href&&(a=a.replace("${gated_href}",gated_href)),e.store.get("gated_href_label")?a=a.replace("${gated_href_label}",e.store.get("gated_href_label")):gated_href_label&&(a=a.replace("${gated_href_label}",gated_href_label)),t.html(a),Mura('.mura-response-success a[href="'+e.store.get("gated_href")+'"]').addClass("mxp-open-gate")}):t.find("div.mura-form-text, div.mura-response-success").each(function(){var t=Mura(this),e=t.html();"undefined"!=typeof gated_href&&gated_href&&(e=e.replace("${gated_href}",gated_href)),"undefined"!=typeof gated_href_label&&gated_href_label&&(e=e.replace("${gated_href_label}",gated_href_label)),t.html(e),"undefined"!=typeof gated_href&&gated_href&&Mura('.mura-response-success  a[href="'+gated_href+'"]').addClass("mxp-open-gate")})}})});