!function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=46)}({1:function(t,e){t.exports=Mura},46:function(t,e,i){i(1),i(47)},47:function(t,e){MuraFileBrowser={config:{resourcepath:"User_Assets",directory:"",height:600,selectMode:0,endpoint:"",completepath:!1,displaymode:2,selectCallback:function(){}},prettify:function(t){},render:function(t){var e=this,i="_"+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),n=window.sessionStorage.getItem("mura_fbfolder");if(n)try{(n=JSON.parse(n)).resourcepath==MuraFileBrowser.config.resourcepath&&n.siteid==Mura.siteid||window.sessionStorage.setItem("mura_fbfolder","")}catch(t){}this.config=Mura.extend(t,this.config),this.endpoint=Mura.apiEndpoint+"filebrowser/",this.container=Mura("#MuraFileBrowserContainer"),this.container.append("<div id='"+i+"'><component :is='currentView'></component></div>"),this.target=i,this.main(),Mura.loader().loadcss(Mura.corepath+"/vendor/cropper/cropper.min.css").loadjs(Mura.adminpath+"/assets/js/vue.min.js",Mura.corepath+"/vendor/cropper/cropper.min.js",(function(){e.mountbrowser()})),this.getURLVars()},main:function(t){},onError:function(t){console.log(t)},getURLVars:function(){var t={};window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,(function(e,i,n){t[i]=n}));t.CKEditorFuncNum&&(this.callback=t.CKEditorFuncNum)},validate:function(){return!0},getGroups:function(t,e,i){if(!this.validate())return error("No Access");Mura.getEntity("filebrowser").invokeWithCSRF("grouppermissions",{resourcePath:this.config.resourcepath,currentFile:t},"post").then((function(t){e(t)}),(function(t){i(t)}))},updatePermissions:function(t,e,i,n,s){if(!this.validate())return error("No Access");Mura.getEntity("filebrowser").invokeWithCSRF("updatepermissions",{resourcePath:this.config.resourcepath,groups:t,haspermissions:e,currentFile:i},"post").then((function(t){n(t)}),(function(t){s(t)}))},moveFile:function(t,e,i,n){if(!this.validate())return error("No Access");Mura.getEntity("filebrowser").invokeWithCSRF("move",{directory:e,destination:i,resourcepath:this.config.resourcepath,filename:t.fullname,completepath:this.config.completepath},"post").then((function(t){n(t)}),(function(t){this.onError(t)}))},getChildDirectory:function(t,e,i){var n=this.endpoint+"/childdir?directory="+t+"&resourcepath="+this.config.resourcepath+"&completepath="+this.config.completepath;if(!this.validate())return error("No Access");Mura.get(n).then((function(t){e(t)}),(function(t){this.onError(t)}))},getEditFile:function(t,e,i){var n=null==t?"":t,s=this.endpoint+"/edit?directory="+n+"&filename="+e.fullname+"&resourcepath="+this.config.resourcepath+"&completepath="+this.config.completepath;if(!this.validate())return error("No Access");Mura.get(s).then((function(t){i(t)}),(function(t){this.onError(t)}))},doDeleteFile:function(t,e,i,n){var s=null==t?"":t;if(!this.validate())return error("No Access");Mura.getEntity("filebrowser").invokeWithCSRF("delete",{directory:s,resourcepath:this.config.resourcepath,filename:e.fullname},"post").then((function(t){i(t)}),(function(t){this.onError(t)}))},doDuplicateFile:function(t,e,i,n){var s=null==t?"":t;if(this.isDisplayContext="",!this.validate())return error("No Access");Mura.getEntity("filebrowser").invokeWithCSRF("duplicate",{directory:s,resourcepath:this.config.resourcepath,filename:e.fullname,completepath:this.config.completepath},"post").then((function(t){i()}),(function(t){}))},doUpdateContent:function(t,e,i,n,s){var r=null==t?"":t;if(!this.validate())return error("No Access");Mura.getEntity("filebrowser").invokeWithCSRF("update",{directory:r,resourcepath:this.config.resourcepath,filename:e.fullname,content:i,completepath:this.config.completepath},"post").then((function(t){n(t)}),(function(t){this.onError(t)}))},doRenameFile:function(t,e,i,n){var s=null==t?"":t;if(!this.validate())return error("No Access");Mura.getEntity("filebrowser").invokeWithCSRF("rename",{directory:s,resourcepath:this.config.resourcepath,filename:e.fullname,name:e.name,completepath:this.config.completepath},"post").then((function(t){i()}),(function(t){this.onError()}))},doNewFolder:function(t,e,i){var n=null==t?"":t;if(!this.validate())return error("No Access");Mura.getEntity("filebrowser").invokeWithCSRF("addfolder",{directory:n,resourcepath:this.config.resourcepath,name:e,completepath:this.config.completepath},"post").then((function(t){i()}),(function(t){onError()}))},loadDirectory:function(t,e,i,n,s,r,o,l,a){var c=null==t?"":t,d=this.endpoint+"browse?directory="+c+"&resourcepath="+this.config.resourcepath+"&completepath="+this.config.completepath;if(!this.validate())return error("No Access");e&&(d+="&pageindex="+e),a&&(d+="&itemsperpage="+a),d+="&sorton="+o,d+="&sortdir="+l,s.length&&(d+="&filterResults="+s),1==r&&(d+="&filterDepth=1"),Mura.get(d).then((function(t){i(t)}),(function(t){n(t)}))},loadBaseDirectory:function(t,e,i){var n=i||this.config.directory,s=this.endpoint+"/browse?resourcepath="+this.config.resourcepath+"&directory="+n+"&settings=1&completepath="+this.config.completepath;if(!this.validate())return error("No Access");Mura.get(s).then((function(e){t(e)}),(function(t){e(t)}))},doUpload:function(t,e,i){if(!this.validate())return error("No Access");t.append("resourcepath",this.config.resourcepath),Mura.getEntity("filebrowser").invokeWithCSRF("upload",t,"post").then((function(t){e(t)}),(function(t){this.onError(t)}))},rotate:function(t,e,i,n){if(!this.validate())return n("No Access");var s={};s.file=JSON.parse(JSON.stringify(t)),s.direction=e,s.resourcepath=this.config.resourcepath,s.completepath=this.config.competepath,Mura.getEntity("filebrowser").invokeWithCSRF("rotate",s,"post").then((function(t){i(t)}),(function(t){this.onError(t)}))},performResize:function(t,e,i,n){if(!this.validate())return n("No Access");var s={};s.file=JSON.parse(JSON.stringify(t)),s.dimensions=e,s.resourcepath=this.config.resourcepath,s.completepath=this.config.competepath,Mura.getEntity("filebrowser").invokeWithCSRF("resize",s,"post").then((function(t){i(t)}),(function(t){this.onError(t)}))},doSaveImage:function(t,e,i,n){if(!this.validate())return n("No Access");e.append("file",JSON.stringify(t)),e.append("resourcepath",this.config.resourcepath),e.append("completepath",this.config.completepath),Mura.getEntity("filebrowser").invokeWithCSRF("saveImage",e,"post").then((function(t){i(t)}),(function(t){this.onError(t)}))},performCrop:function(t,e,i){if(!this.validate())return i("No Access");var n={},s=document.getElementById("imagediv"),r=document.getElementById("croprectangle"),o=r.getBoundingClientRect(),l=(t.info.width,t.info.height,{width:s.clientWidth,height:s.clientHeight}),a={x:0,y:0,width:0,height:0};a.x=r.offsetLeft,a.y=r.offsetTop,a.width=o.width,a.height=o.height,n.file=JSON.parse(JSON.stringify(t)),n.crop=a,n.size=l,n.resourcepath=this.config.resourcepath,n.completepath=this.config.completepath,Mura.getEntity("filebrowser").invokeWithCSRF("processCrop",n,"post").then((function(t){e(t)}),(function(t){this.onError(t)}))},crop:function(t,e){if(1!=e){var i={x:0,y:0,startX:0,startY:0},n=null;t.onmousemove=function(t){null!==n&&(r(t),n.style.width=Math.abs(i.x-i.startX)+"px",n.style.height=Math.abs(i.y-i.startY)+"px",n.style.left=i.x-i.startX<0?i.x+"px":i.startX+"px",n.style.top=i.y-i.startY<0?i.y+"px":i.startY+"px")},t.onmouseup=function(e){n=null,t.style.cursor="default"},t.onmousedown=function(e){if(null!==n);else{var s=document.getElementById("croprectangle");s&&s.parentNode.removeChild(s),r(e),i.startX=i.x,i.startY=i.y;t.getBoundingClientRect();(n=document.createElement("div")).className="rectangle",n.id="croprectangle",n.style.width=Math.abs(i.x-i.startX)+"px",n.style.height=Math.abs(i.y-i.startY)+"px",n.style.left=i.x-i.startX<0?i.x+"px":i.startX+"px",n.style.top=i.y-i.startY<0?i.y+"px":i.startY+"px",t.appendChild(n),t.style.cursor="crosshair"}}}else{var s=document.getElementById("croprectangle");s&&s.parentNode.removeChild(s)}function r(e){var n=e||window.event;t.getBoundingClientRect();n.pageX?e.target!=document.getElementById("imagediv")?(i.x=e.offsetX+e.target.offsetLeft,i.y=e.offsetY+e.target.offsetTop):(i.x=n.offsetX,i.y=n.offsetY):n.clientX&&(i.x=n.offsetX,i.y=n.offsetY)}},mountbrowser:function(){var t=this;Vue.directive("click-outside",{bind:function(t,e,i){t.clickOutsideEvent=function(n){t==n.target||t.contains(n.target)||i.context[e.expression](n)},document.body.addEventListener("click",t.clickOutsideEvent)},unbind:function(t){document.body.removeEventListener("click",t.clickOutsideEvent)}}),Vue.component("contextmenu",{props:["currentFile","menuy","menux","settings"],template:'\n\t\t\t<div id="newContentMenu" class="addNew fileviewer-menu" v-bind:style="{  \'white-space\': \'initial !important\' }">\n\t\t\t\t\t<ul id="newContentOptions" :style="{ \'white-space\': \'initial !important\' }">\n\t\t\t\t\t\t<li v-if="checkIsFile() && checkSelectMode()"><a href="#" @click.prevent="selectFile()"><i class="mi-check"></i>{{settings.rb.filebrowser_select}}</a></li>\n\t\t\t\t\t\t<li v-if="checkIsFile() && checkFileEditable()"><a href="#" @click.prevent="editFile()"><i class="mi-pencil"></i>{{settings.rb.filebrowser_edit}}</a></li>\n\t\t\t\t\t\t<li v-if="checkIsFile() && checkImageType()"><a href="#" @click.prevent="viewFile()"><i class="mi-image"></i>{{settings.rb.filebrowser_view}}</a></li>\n\t\t\t\t\t\t<li v-if="checkIsFile() || checkImageType()"><a href="#" @click.prevent="moveFile()"><i class="mi-move"></i>{{settings.rb.filebrowser_move}}</a></li>\n\t\t\t\t\t\t<li v-if="checkIsFile() || checkImageType()"><a href="#" @click.prevent="duplicateFile()"><i class="mi-copy"></i>{{settings.rb.filebrowser_duplicate}}</a></li>\n\t\t\t\t\t\t<li v-if="checkIsFile() || checkImageType()"><a href="#" @click.prevent="copyUrl()"><i class="mi-copy"></i>{{settings.rb.filebrowser_copyurl}}</a></li>\n\t\t\t\t\t\t<li><a href="#" @click.prevent="renameFile()"><i class="mi-edit"> {{settings.rb.filebrowser_rename}}</i></a></li>\n\t\t\t\t\t\t<li v-if="!checkIsFile() && checkIsAdmin() && checkIsUserArea()"><a href="#" @click="setPermissions()"><i class="mi-users"> {{settings.rb.filebrowser_permissions}}</i></a></li>\n\t\t\t\t\t\t<li v-if="checkIsFile()"><a href="#" @click="downloadFile()"><i class="mi-download"> {{settings.rb.filebrowser_download}}</i></a></li>\n\t\t\t\t\t\t<li class="delete"><a href="#" @click.prevent="deleteFile()"><i class="mi-trash"> {{settings.rb.filebrowser_delete}}</i></a></li>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t',data:function(){return{posx:0,posy:0}},computed:{},mounted:function(){document.getElementById("MuraFileBrowserContainer")&&(document.getElementById("MuraFileBrowserContainer").parentNode==document.getElementById("alertDialogMessage")&&(document.getElementsByClassName("ui-dialog")[0].style.overflow="initial"));if(window.gridMode){var t=document.getElementById("fileitem-"+window.index).parentElement.parentElement.parentElement;t.style.overflow="visible",(s=this.$el).className="addNew fileviewer-menu-grid",t.appendChild(s);var e=s.getBoundingClientRect().height;t.getBoundingClientRect().bottom+e>window.innerHeight?s.style.bottom="0px":s.style.top=t.getBoundingClientRect().height+"px"}else{var i=document.getElementById("fileitem-"+window.index).parentElement,n=i.parentElement;n.className="fileviewer-selected-row",window.tr=n;var s=this.$el;i.appendChild(s);var r=i.getBoundingClientRect().bottom,o=(e=s.getBoundingClientRect().height,n.getBoundingClientRect().height);if(r+e>window.innerHeight){var l=o;s.style.marginBottom="0",s.style.bottom=l+"px"}else{var a=o;s.style.top=a+"px"}}},methods:{compstyle:function(){this.posx=this.menux,this.posy=this.menuy},getTop:function(){return this.menuy+window.pageYOffset},selectFile:function(){if(1!=MuraFileBrowser.config.selectMode)return MuraFileBrowser.config.selectCallback(e.currentFile);window.opener.CKEDITOR.tools.callFunction(t.callback,e.currentFile.url),window.close()},copyUrl:function(){var t=e.currentFile.url,i=document.createElement("textarea");i.id="::urlcopy",document.getElementById("MuraFileBrowserContainer").appendChild(i);var n=document.getElementById("::urlcopy");n.value=t,n.select(),document.execCommand("copy"),n.remove(),e.isDisplayContext=""},setPermissions:function(){e.isDisplayWindow="PERM"},moveFile:function(){e.isDisplayWindow="MOVE"},editFile:function(){e.editFile(this.successEditFile)},duplicateFile:function(){e.isDisplayWindow="",e.duplicateFile(e.refresh,e.displayError)},viewFile:function(){e.isDisplayWindow="VIEW",e.viewFile()},successEditFile:function(t){this.currentFile.content=t.data.content,e.isDisplayWindow="EDIT"},renameFile:function(){e.isDisplayWindow="RENAME"},downloadFile:function(){window.open(e.currentFile.url,"_blank")},deleteFile:function(){e.isDisplayWindow="DELETE"},checkSelectMode:function(){return e.checkSelectMode()},checkFileEditable:function(){return e.checkFileEditable()},checkImageType:function(){return e.checkImageType()},checkIsFile:function(){return e.checkIsFile()},checkIsAdmin:function(){return e.isAdmin},checkIsUserArea:function(){return e.checkIsUserArea()}}}),Vue.component("actionwindow",{props:["isDisplayWindow","foldertree","currentFile","currentIndex","error","settings"],template:'\n\t\t\t\t<div>\n\t\t\t\t\t<div id="actionwindow-wrapper" class="editwindow" v-if="isDisplayWindow==\'EDIT\'">\n\t\t\t\t\t\t<editwindow :settings="settings" v-if="isDisplayWindow==\'EDIT\'" :currentFile="currentFile"></editwindow>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-else id="actionwindow-wrapper">\n\t\t\t\t\t\t<renamewindow :settings="settings" v-if="isDisplayWindow==\'RENAME\'" :currentFile="currentFile"></renamewindow>\n\t\t\t\t\t\t<permwindow :settings="settings" v-if="isDisplayWindow==\'PERM\'" :foldertree="foldertree" :currentFile="currentFile"></permwindow>\n\t\t\t\t\t\t<movewindow :settings="settings" v-if="isDisplayWindow==\'MOVE\'" :foldertree="foldertree" :currentFile="currentFile"></movewindow>\n\t\t\t\t\t\t<addfolderwindow :settings="settings" v-if="isDisplayWindow==\'ADDFOLDER\'" :currentFile="currentFile"></addfolderwindow>\n\t\t\t\t\t\t<downloadwindow :settings="settings" v-if="isDisplayWindow==\'DOWNLOAD\'" :currentFile="currentFile"></downloadwindow>\n\t\t\t\t\t\t<deletewindow :settings="settings" v-if="isDisplayWindow==\'DELETE\'" :foldertree="foldertree" :currentFile="currentFile"></deletewindow>\n\t\t\t\t\t\t<errorwindow :settings="settings" v-if="isDisplayWindow==\'ERROR\'" :currentFile="currentFile" :error="error"></errorwindow>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t',data:function(){return{}},methods:{}}),Vue.component("permwindow",{props:["groups","currentFile","groupperms","hasfolderpermission","loading","isperm","settings"],template:'\n\t\t\t\t<div class="ui-dialog dialog-info actionwindow-formwrapper" id="permissionswindow">\n\t\t\t\t\t<div class="block block-constrain">\n\t\t\t\t\t\t<div class="block-content">\n\t\t\t\t\t\t\t<div class="mura-header">\n\t\t\t\t\t\t\t\t<h1>{{settings.rb.filebrowser_permissions}}</h1>\n\t\t\t\t\t\t\t\t<label>{{settings.rb.filebrowser_forfolder}}: <span>{{currentFile.name}}</span></label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div v-if="isperm" class="mura-control-group" id="permissionswrapper">\n\t\t\t\t\t\t\t\t<div v-bind:class="{ isContainerDisabled: this.hasfolderpermission }">\n\t\t\t\t\t\t\t\t\t<label class="radio inline">\n\t\t\t\t\t\t\t\t\t\t<input type="radio" v-model="hasfolderpermission" :value="0" name="hasfolderpermission" :checked="hasfolderpermission"> {{settings.rb.filebrowser_inherit}}\n\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div v-bind:class="{ isContainerDisabled: !this.hasfolderpermission }">\n\t\t\t\t\t\t\t\t\t<label class="radio inline">\n\t\t\t\t\t\t\t\t\t\t<input type="radio" v-model="hasfolderpermission" :value="1" name="hasfolderpermission" :checked="hasfolderpermission"> {{settings.rb.filebrowser_custom}}\n\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t<div v-if="hasfolderpermission" id="permissionscontainer">\n\t\t\t\t\t\t\t\t\t\t<table class="mura-table-grid">\n\t\t\t\t\t\t\t\t\t\t\t<thead>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<th>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{{settings.rb.filebrowser_allow}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<th>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{{settings.rb.filebrowser_deny}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<th class="var-width">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{{settings.rb.filebrowser_group}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t</thead>\n\t\t\t\t\t\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr v-for="group in groups">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type="radio" :id="group.userid" v-model="group.perm" value="editor" :name="group.userid" :checked="group.perm == \'editor\'">\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type="radio" :id="group.userid" v-model="group.perm" value="deny" :name="group.userid" :checked="group.perm == \'deny\'">\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class="var-width">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{group.groupname}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t</tbody>\n\t\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>               \n\t\t\t\t\t\t\t<div class="buttonset">\n\t\t\t\t\t\t\t\t<button class="mura-secondary" @click="cancel()"><i class="mi-ban"></i>{{settings.rb.filebrowser_cancel}}</button>\n\t\t\t\t\t\t\t\t<button v-if="isperm" @click="updatePermissions()"><i class="mi-check"></i>{{settings.rb.filebrowser_save}}</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t',data:function(){return{filename:""}},methods:{updatePermissions:function(){e.spinnermodal=1,MuraFileBrowser.updatePermissions(this.groups,this.hasfolderpermission,this.currentFile,this.permissionsUpdated,this.error),e.isDisplayWindow=""},cancel:function(){e.isDisplayWindow=""},setGroups:function(t){this.loading=0,this.hasfolderpermission=parseInt(t.hasfolderpermission),e.spinnermodal=0,this.groups=t.groups,this.members=t.members},permissionsUpdated:function(t){e.spinnermodal=0,e.isDisplayWindow=""},error:function(t){e.spinnermodal=0,this.isperm=0}},mounted:function(){this.loading=1,this.isperm=1,e.spinnermodal=1,this.groups=[],this.hasfolderpermission=0,e.isDisplayContext=0,MuraFileBrowser.getGroups(this.currentFile,this.setGroups,this.error)}}),Vue.component("movewindow",{props:["currentFile","foldertree","settings"],template:'\n\t\t\t<div class="ui-dialog dialog-info actionwindow-formwrapper actionwindow-long">\n\t\t\t\t<div class="block block-constrain">\n\t\t\t\t\t<div class="block-content">\n\t\t\t\t\t\t<div class="mura-header">\n\t\t\t\t\t\t\t<h1>{{settings.rb.filebrowser_movefile}}</h1>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="mura-control-group">\n\t\t\t\t\t\t\t<label>{{settings.rb.filebrowser_name}}: <span>{{currentFile.fullname}}</span></label>\n\t\t\t\t\t\t\t<label>{{settings.rb.filebrowser_location}}: <span>{{this.$root.resourcepath}}</span>{{currentFile.subfolder}}</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="mura-control-group">\n\t\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t\t{{settings.rb.filebrowser_moveto}}:\n\t\t\t\t\t\t\t\t<span><a @click="setDirDepth(-1)" class="folder-item">{{this.$root.resourcepath}}</a></span><span v-for="(item,index) in sourcefolders" @click="setDirDepth(index)">/<a class="folder-item">{{item}}</a></span>\n\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t<select v-if="childFolders.length" v-model="folderName">\n\t\t\t\t\t\t\t\t\t\t<option v-if="item.length" v-for="item in childFolders" :value="item">/{{item}}</option>\n\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</div>\n\t\x3c!--\n\t\t\t\t\t\t<div class="mura-control-group">\n\t\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t{{settings.rb.filebrowser_destination}}:\n\t\t\t\t\t\t\t\t<input type="text" v-model="destinationFolder" style="width: 80%"></input>\n\t\t\t\t\t\t\t\t<span class="small">{{invalid}}</span>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</div>\n\t--\x3e\n\t\t\t\t\t\t<div class="buttonset">\n\t\t\t\t\t\t\t<button @click="moveFile()"><i class="mi-check"></i>{{settings.rb.filebrowser_move}}</button>\n\t\t\t\t\t\t\t<button class="mura-secondary" @click="cancel()"><i class="mi-ban"></i>{{settings.rb.filebrowser_cancel}}</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t',data:function(){return{resourcename:"",folderName:"",sourcefolders:[],childFolders:[],invalid:""}},watch:{folderName:function(t){if(""!=this.folderPath){this.sourcefolders.push(this.folderName);var n="";for(i in this.sourcefolders)n+="/"+this.sourcefolders[i];this.childFolders=[],MuraFileBrowser.getChildDirectory(n,this.updateDirectory,e)}}},methods:{moveFile:function(){var t=this.currentFile.subfolder,n="";for(i in this.sourcefolders)n+="/"+this.sourcefolders[i];e.spinnermodal=1,MuraFileBrowser.moveFile(this.currentFile,t,n,this.fileMoved)},fileMoved:function(){e.isDisplayWindow="",e.refresh()},updateDirectory:function(t){console.log("updateDirectory"),console.log(t),parseInt(t.data.valid)?(this.invalid="",this.childFolders=t.data.folders):(this.childFolders=[],this.invalid="(This does not appear to be a valid directory)")},setDirDepth:function(t){t+=1,this.sourcefolders.length=t;var n="";for(i in this.sourcefolders)n+="/"+this.sourcefolders[i];this.childFolders=[],MuraFileBrowser.getChildDirectory(n,this.updateDirectory,e)},cancel:function(){e.isDisplayWindow=""}},mounted:function(){this.sourcefolders=this.currentFile.subfolder.split("/"),this.filename=this.currentFile.name,e.isDisplayContext=0;var t="";for(i in this.sourcefolders)t+="/"+this.sourcefolders[i];switch(this.sourcefolders=this.sourcefolders.filter((function(t){return""!==t})),MuraFileBrowser.getChildDirectory(t,this.updateDirectory,e),MuraFileBrowser.config.resourcepath){case"Site_Files":this.resourcename="Site Files";break;case"Application_Root":this.resourcename="Application Root";break;default:this.resourcename="User Assets"}}}),Vue.component("renamewindow",{props:["currentFile","settings"],template:'\n\t\t\t\t<div class="ui-dialog dialog-info actionwindow-formwrapper">\n\t\t\t\t\t<div class="block block-constrain">\n\t\t\t\t\t\t<div class="block-content">\n\t\t\t\t\t\t\t<div class="mura-header">\n\t\t\t\t\t\t\t\t<h1 v-if="parseInt(currentFile.isfolder)">{{settings.rb.filebrowser_renamefolder}}</h1>\n\t\t\t\t\t\t\t\t<h1 v-else>{{settings.rb.filebrowser_renamefile}}</h1>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="mura-control-group">\n\t\t\t\t\t\t\t\t<label v-if="parseInt(currentFile.isfolder)">{{settings.rb.filebrowser_foldername}}: <span>{{currentFile.name}}</span></label>\n\t\t\t\t\t\t\t\t<label v-else>{{settings.rb.filebrowser_filename}}: <span>{{currentFile.name}}</span><span v-if="currentFile.ext != currentFile.name">.{{currentFile.ext}}</span></label>\n\t\t\t\t\t\t\t\t<label v-if="parseInt(currentFile.isfolder)">{{settings.rb.filebrowser_newname}}: <span><input type="text" @keyup="cleanName" v-model="filename"></input></span></label>\n\t\t\t\t\t\t\t\t<label v-else>{{settings.rb.filebrowser_newname}}: <span><input type="text" @keyup="cleanName" v-model="filename"></input></span><span v-if="currentFile.ext != currentFile.name">.{{currentFile.ext}}</span></label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="buttonset">\n\t\t\t\t\t\t\t\t<button @click="updateRename()"><i class="mi-check"></i>{{settings.rb.filebrowser_save}}</button>\n\t\t\t\t\t\t\t\t<button class="mura-secondary" @click="cancel()"><i class="mi-ban"></i>{{settings.rb.filebrowser_cancel}}</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t',data:function(){return{filename:""}},methods:{cleanName:function(t){this.filename=this.filterName(this.filename)},filterName:function(t){return t=(t=t.replace(/[^a-zA-Z\d-/\s\.\w/]+/gi,"-")).replace(/-{2,}/g,"-")},updateRename:function(){this.cleanName(),this.currentFile.name=this.filename.trim(),"-"===this.currentFile.name.slice(-1)&&(this.currentFile.name=this.currentFile.name.slice(0,-1),this.currentFile.name.trim()),e.renameFile(),e.isDisplayWindow=""},cancel:function(){e.isDisplayWindow=""}},mounted:function(){this.filename=this.currentFile.name,e.isDisplayContext=0}}),Vue.component("errorwindow",{props:["error","settings"],template:'\n\t\t\t\t<div class="ui-dialog dialog-warning actionwindow-formwrapper">\n\t\t\t\t\t<div class="block block-constrain">\n\t\t\t\t\t\t<div class="block-content">\n\t\t\t\t\t\t\t<div class="mura-header">\n\t\t\t\t\t\t\t\t<h1>{{settings.rb.filebrowser_error}}</h1>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<h4>{{error}}</h4>\n\t\t\t\t\t\t\t<div class="buttonset">\n\t\t\t\t\t\t\t\t<button @click="cancel()"><i class="mi-close"></i>{{settings.rb.filebrowser_close}}</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t',data:function(){return{filename:""}},methods:{cancel:function(){e.isDisplayWindow=""}}}),Vue.component("addfolderwindow",{props:["currentFile","settings"],template:'\n\t\t\t\t<div class="ui-dialog dialog-info actionwindow-formwrapper">\n\t\t\t\t\t<div class="block block-constrain">\n\t\t\t\t\t\t<div class="block-content">\n\t\t\t\t\t\t\t<div class="mura-header">\n\t\t\t\t\t\t\t\t<h1>{{settings.rb.filebrowser_addfolder}}</h1>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="mura-control-group">\n\t\t\t\t\t\t\t\t<label>{{settings.rb.filebrowser_foldername}}: <span><input type="text" @keyup="cleanName" v-model="foldername"></input></span></label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="buttonset">\n\t\t\t\t\t\t\t\t<button @click="newFolder()"><i class="mi-check"></i>{{settings.rb.filebrowser_save}}</button>\n\t\t\t\t\t\t\t\t<button class="mura-secondary" @click="cancel()"><i class="mi-ban"></i>{{settings.rb.filebrowser_cancel}}</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t',data:function(){return{foldername:""}},methods:{cleanName:function(t){this.foldername=this.filterName(this.foldername)},filterName:function(t){return t=(t=t.replace(/[^a-zA-Z\d-/\s\.\w/]+/gi,"-")).replace(/-{2,}/g,"-")},newFolder:function(){this.cleanName(),this.foldername=this.foldername.trim(),"-"===this.foldername.slice(-1)&&(this.foldername=this.foldername.slice(0,-1),this.foldername=this.foldername.trim()),e.newFolder(this.foldername),e.isDisplayWindow=""},cancel:function(){e.isDisplayWindow=""}},mounted:function(){}}),Vue.component("gallerywindow",{props:["currentFile","currentIndex","total","settings"],template:'\n\t\t\t<div class="fileviewer-modal" v-if="currentFile.ext.toLowerCase()==\'svg\' || currentFile.info.width">\n\t\t\t\t<div class="fileviewer-gallery" v-click-outside="closewindow">\n\t\t\t\t\t<div class="fileviewer-image" :style="{ \'background-image\': \'url(\' + encodeURI(currentFile.url) + \'?\' + Math.ceil(Math.random()*100000) + \')\' }"></div>\n\t\t\t\t\t<div class="actionwindow-left" @click="lastimage"><i class="mi-caret-left"></i></div>\n\t\t\t\t\t<div class="actionwindow-right" @click="nextimage"><i class="mi-caret-right"></i></div>\n\t\t\t\t\t<div class="fileviewer-gallery-menu mura-actions">\n\t\t\t\t\t\t<label class="fileinfo"> {{currentFile.subfolder}}/{{currentFile.fullname}} ({{currentFile.size}}kb <span v-if="checkImageType()">{{currentFile.info.width}}x{{currentFile.info.height}}</span>)</label>\n\t\t\t\t\t\t<div class="form-actions">\n\t\t\t\t\t\t\t<a v-if="checkImageType() && checkSelectMode()" class="btn mura-primary" @click="selectFile()"><i class="mi-check"></i>{{settings.rb.filebrowser_select}}</a>\n\t\t\t\t\t\t\t<a v-if="checkImageType() && currentFile.ext.toLowerCase() !=\'svg\'" class="btn mura-primary" @click="editImage()"><i class="mi-crop"></i>{{settings.rb.filebrowser_editimage}}</a>\n\t\t\t\t\t\t\t<a v-if="checkFileEditable()" class="btn mura-primary" @click="editFile()"><i class="mi-pencil"></i>{{settings.rb.filebrowser_edit}}</a>\n\t\t\t\t\t\t\t<a class="btn mura-primary" @click="renameFile()"><i class="mi-edit"></i>{{settings.rb.filebrowser_rename}}</a>\n\t\t\t\t\t\t\t<a v-if="checkIsFile()" class="btn mura-primary" @click="downloadFile()"><i class="mi-download"></i>{{settings.rb.filebrowser_download}}</a>\n\t\t\t\t\t\t\t<a class="btn" @click="deleteFile()"><i class="mi-trash"></i>{{settings.rb.filebrowser_delete}}</a>\n\t\t\t\t\t\t\t<a class="btn" @click="closewindow()"><i class="mi-times"></i>{{settings.rb.filebrowser_close}}</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t',data:function(){return{}},mounted:function(){if("svg"!=e.currentFile.ext.toLowerCase()&&void 0===e.currentFile.info.width){for(var t="",i=0;i<e.foldertree.length;i++)t=t+"/"+e.foldertree[i];e.currentFile.url.match(/.*\//i);Mura.getEntity("filebrowser").invoke("getImageInfo",{directory:t,subfolder:e.currentFile.subfolder,resourcepath:MuraFileBrowser.config.resourcepath,filename:e.currentFile.fullname}).then((function(t){e.currentFile.info=t}))}this.$root.isDisplayContext=0},methods:{lastimage:function(){e.previousFile(1)},nextimage:function(){e.nextFile(1)},closewindow:function(t){this.$root.isDisplayWindow=""},renameFile:function(){e.isDisplayWindow="RENAME"},editImage:function(){e.isDisplayWindow="EDITIMAGE"},selectFile:function(){if(1!=MuraFileBrowser.config.selectMode)return MuraFileBrowser.config.selectCallback(e.currentFile);window.opener.CKEDITOR.tools.callFunction(t.callback,e.currentFile.url),window.close()},downloadFile:function(){window.open(e.currentFile.url,"_blank")},deleteFile:function(){e.isDisplayWindow="DELETE"},checkSelectMode:function(){return e.checkSelectMode()},checkFileEditable:function(){return e.checkFileEditable()},checkImageType:function(){return e.checkImageType()},checkIsFile:function(){return e.checkIsFile()}}}),Vue.component("imageeditwindow",{props:["currentFile","currentIndex","total","settings"],template:'\n\t\t\t<div class="fileviewer-modal">\n\t\t\t\t<imageeditmenu class="fileviewer-gallery" :settings="settings" :currentFile="currentFile" :currentIndex="currentIndex" v-click-outside="closewindow"></imageeditmenu>\n\t\t\t</div>\n\t\t\t',data:function(){return{}},mounted:function(){},methods:{closewindow:function(t){this.$root.isDisplayWindow=""}}}),Vue.component("imageeditmenu",{props:["currentFile","currentIndex","imageEditTarget","settings"],template:'\n\t\t\t\t <div>\n\t\t\t\t <div v-if="this.editmode  == \'RESIZE\'" class="fileviewer-image" id="imagediv" :style="{ \'background-image\': \'url(\' + encodeURI(currentFile.url) + \'?\' + Math.ceil(Math.random()*100000) + \')\' }"></div>\n\t\t\t\t <div v-if="this.editmode == \'\'" class="fileviewer-image-edit"><img style="min-height: 100%" id="fileviewer-image-editable" :src="currentFile.url"></div>\n\t\t\t\t\t<div class="fileviewer-edit-menu mura-actions">\n\t\t\t\t\t\t<label class="fileinfo">{{currentFile.fullname}} ({{currentFile.size}}kb {{currentFile.info.width}}x{{currentFile.info.height}})</label>\n\t\t\t\t\t\t\x3c!-- MAIN --\x3e\n\t\t\t\t\t\t<div class="form-actions" v-if="editmode==\'\'">\n\t\n\t\t\t\t\t\t\t<a class="btn mura-primary" @click="resize()"><i class="mi-expand"></i>{{settings.rb.filebrowser_resize}}</a>\n\t\t\t\t\t\t\t<a class="btn mura-primary" @click="saveImage()"><i class="mi-check"></i>{{settings.rb.filebrowser_confirm}}</a>\n\t\t\t\t\t\t\t<a class="btn" @click="cancel()"><i class="mi-ban"></i>{{settings.rb.filebrowser_cancel}}</a>\n\t\n\t\t\t\t\t\t\t<div class="form-actions-toolbar">\n\t\n\t\t\t\t\t\t\t\t<div class="btn-group d-flex flex-nowrap">\n\t\t\t\t\t\t\t\t\t<a class="btn mura-primary" :title="settings.rb.filebrowser_zoomin" @click="zoomIn()"><i class="mi-search-plus"></i></a>\n\t\t\t\t\t\t\t\t\t<a class="btn mura-primary" :title="settings.rb.filebrowser_zoomout" @click="zoomOut()"><i class="mi-search-minus"></i></a>\n\t\t\t\t\t\t\t\t\t<a class="btn mura-primary" :title="settings.rb.filebrowser_rotateright" @click="rotateRight()"><i class="mi-rotate-right"></i></a>\n\t\t\t\t\t\t\t\t\t<a class="btn mura-primary" :title="settings.rb.filebrowser_rotateleft" @click="rotateLeft()"><i class="mi-rotate-left"></i></a>\n\t\t\t\t\t\t\t\t</div>\n\t\n\t\t\t\t\t\t\t\t<div class="btn-group d-flex flex-nowrap">\n\t\t\t\t\t\t\t\t\t<a class="btn mura-primary" :title="settings.rb.filebrowser_move" @click="moveMode()"><i class="mi-move"></i></a>\n\t\t\t\t\t\t\t\t\t<a class="btn mura-primary" :title="settings.rb.filebrowser_crop" @click="cropMode()"><i class="mi-crop"></i></a>\n\t\t\t\t\t\t\t\t</div>\n\t\n\t\t\t\t\t\t\t\t<div class="btn-group d-flex flex-nowrap">\n\t\t\t\t\t\t\t\t\t<label v-for="aspect in settings.aspectratios" class="btn mura-primary" :title="titleaspectratios(settings.rb.filebrowser_aspectratio,aspect[0],aspect[1])" :class="{ \'active\': cropaspect == aspect[2] }">\n\t\t\t\t\t\t\t\t\t\t<input type="radio" class="sr-only" id="cropaspect1" name="cropaspect" v-model="cropaspect" :value="aspect[2]">\n\t\t\t\t\t\t\t\t\t\t<span class="docs-tooltip" data-toggle="tooltip" title="" :data-original-title="titleaspectratios(settings.rb.filebrowser_aspectratio,aspect[0],aspect[1])">\n\t\t\t\t\t\t\t\t\t\t\t{{aspect[0]}}:{{aspect[1]}}\n\t\t\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t<label class="btn mura-primary" :title="settings.rb.filebrowser_aspectratiofixed" :class="{ \'active\': cropaspect == fixedwidth }">\n\t\t\t\t\t\t\t\t\t\t<input type="radio" class="sr-only" id="cropaspect5" name="cropaspect" v-model="cropaspect" :value="fixedwidth">\n\t\t\t\t\t\t\t\t\t\t<span class="docs-tooltip" data-toggle="tooltip" title="" :data-original-title="settings.rb.filebrowser_aspectratiofixed">\n\t\t\t\t\t\t\t\t\t\t{{settings.rb.filebrowser_fixed}}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t<label class="btn mura-primary" :title="settings.rb.filebrowser_aspectratiofree" :class="{ \'active\': cropaspect == NaN }">\n\t\t\t\t\t\t\t\t\t\t<input type="radio" class="sr-only" id="cropaspect5" name="cropaspect" v-model="cropaspect" value="NaN">\n\t\t\t\t\t\t\t\t\t\t<span class="docs-tooltip" data-toggle="tooltip" title="" :data-original-title="settings.rb.filebrowser_aspectratiofree">\n\t\t\t\t\t\t\t\t\t\t{{settings.rb.filebrowser_free}}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div> \x3c!-- /.form-actions-toolbar --\x3e\n\t\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\x3c!-- RESIZE --\x3e\n\t\t\t\t\t\t<div class="form-actions" v-if="editmode==\'RESIZE\'">\n\t\t\t\t\t\t\t<label>{{settings.rb.filebrowser_width}}: <input class="numeric" :disabled="resizedimensions.aspect == \'height\'" name="resize-width" @keyup="changedAspectWidth" v-model="resizedimensions.width"></label>\n\t\t\t\t\t\t\t<label>{{settings.rb.filebrowser_height}}: <input class="numeric" :disabled="resizedimensions.aspect == \'width\'" name="resize-height" @keyup="changedAspectHeight" v-model="resizedimensions.height"></label>\n\t\t\t\t\t\t\t<label>{{settings.rb.filebrowser_aspect}}:\n\t\t\t\t\t\t\t\t<select name="resize-aspect" v-model="resizedimensions.aspect" @change="changedAspect">\n\t\t\t\t\t\t\t\t\t<option value="none">{{settings.rb.filebrowser_resizenone}}</option>\n\t\t\t\t\t\t\t\t\t<option value="height">{{settings.rb.filebrowser_resizeheight}}</option>\n\t\t\t\t\t\t\t\t\t<option value="width">{{settings.rb.filebrowser_resizewidth}}</option>\n\t\t\t\t\t\t\t\t\t<option value="within">{{settings.rb.filebrowser_resizewithin}}</option>\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t<a class="btn mura-primary" @click="confirmResize()"><i class="mi-check"></i>{{settings.rb.filebrowser_confirm}}</a>\n\t\t\t\t\t\t\t<a class="btn" @click="cancelResize()"><i class="mi-ban"></i>{{settings.rb.filebrowser_cancel}}</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="preview-window" v-if="this.showpreview">\n\t\t\t\t\t\t<div class="preview-mast"></div>\n\t\t\t\t\t\t<div class="preview-image">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t',data:function(){return{editmode:"",resizedimensions:{width:0,height:0,backup:0,aspect:"none"},showpreview:0,cropaspect:"4:3",fixedwidth:1}},watch:{cropaspect:function(t){this.setAspectRatio(t)}},mounted:function(){this.resizedimensions.width=this.currentFile.info.width,this.resizedimensions.height=this.currentFile.info.height,this.$root.isDisplayContext=0,this.editmode="",this.fixedwidth=Math.ceil(this.currentFile.info.width/this.currentFile.info.height*1e4)/1e4,this.initCropper()},methods:{titleaspectratios:function(t,e,i){return t+":"+e+"/"+i},updateData:function(t){this.imageEditCropMode=t},changedAspect:function(){},changedAspectWidth:function(){"width"==this.resizedimensions.aspect&&this.resizedimensions.width>0&&(this.resizedimensions.height=Math.ceil(this.resizedimensions.width/this.currentFile.info.width*this.currentFile.info.height))},changedAspectHeight:function(){"height"==this.resizedimensions.aspect&&this.resizedimensions.height>0&&(this.resizedimensions.width=Math.ceil(this.resizedimensions.height/this.currentFile.info.height*this.currentFile.info.width))},destroyCropper:function(){imageEditTarget.destroy()},initCropper:function(){var t=document.getElementById("fileviewer-image-editable"),e=this.cropaspect;imageEditTarget=new Cropper(t,{aspectRatio:e,crop:function(t){}})},saveImage:function(){for(var t=this,i="",n=0;n<e.foldertree.length;n++)i=i+"/"+e.foldertree[n];imageEditTarget.getCroppedCanvas().toBlob((function(e){var n=document.createElement("img"),s=URL.createObjectURL(e);n.onload=function(){URL.revokeObjectURL(s)};var r=new FormData;r.append("croppedImage",e,t.currentFile.fullname),r.append("dir",i),n.src=s,MuraFileBrowser.doSaveImage(t.currentFile,r,t.fileSaved)}))},fileSaved:function(){this.$root.isDisplayWindow="VIEW",this.editmode="",e.refresh()},zoomIn:function(){imageEditTarget.zoom(.1)},zoomOut:function(){imageEditTarget.zoom(-.1)},setAspectRatio:function(t){imageEditTarget.setAspectRatio(t)},rotateLeft:function(){imageEditTarget.rotate(-15)},rotateRight:function(){imageEditTarget.rotate(15)},resize:function(){this.editmode="RESIZE",this.destroyCropper()},cropMode:function(){imageEditTarget.setDragMode("crop")},moveMode:function(){imageEditTarget.setDragMode("move")},closewindow:function(t){this.$root.isDisplayWindow=""},cancel:function(t){this.destroyCropper(),this.$root.isDisplayWindow="VIEW",this.editmode=""},confirmResize:function(){MuraFileBrowser.performResize(this.currentFile,this.resizedimensions,this.resizeComplete)},resizeComplete:function(){this.$root.refresh(),this.$root.isDisplayWindow=""},cancelResize:function(t){this.editmode="",this.$nextTick((function(){this.initCropper()}))}}}),Vue.component("deletewindow",{props:["currentFile","foldertree","settings"],template:'\n\t\t\t<div class="ui-dialog dialog-warning actionwindow-formwrapper">\n\t\t\t\t<div class="block block-constrain">\n\t\t\t\t\t<div class="block-content">\n\t\t\t\t\t\t<div class="mura-header">\n\t\t\t\t\t\t\t<h1 v-if="parseInt(currentFile.isfolder)">{{settings.rb.filebrowser_deletefolder}}</h1>\n\t\t\t\t\t\t\t<h1 v-else>{{settings.rb.filebrowser_deletefile}}</h1>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="mura-control-group">\n\t\t\t\t\t\t\t<label v-if="parseInt(currentFile.isfolder)">{{settings.rb.filebrowser_areyousurefolder}}?</label>\n\t\t\t\t\t\t\t<label v-else>{{settings.rb.filebrowser_areyousurefile}}?</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="mura-control-group">\n\t\t\t\t\t\t\t<label v-if="parseInt(currentFile.isfolder)">{{settings.rb.filebrowser_folder}}: <span>{{this.$root.resourcepath}}</span><span v-for="(item, index) in foldertree">/{{item}}</span>/<span>{{currentFile.fullname}}</span></label>\n\t\t\t\t\t\t\t<label v-else>{{settings.rb.filebrowser_file}}: <span>{{this.$root.resourcepath}}</span><span>{{currentFile.subfolder}}/{{currentFile.fullname}}</span></label>\n\t\t\t\t\t\t\t<label>{{settings.rb.filebrowser_modified}}: <span>{{currentFile.lastmodified.substring(0, currentFile.lastmodified.lastIndexOf(" ") )}}</span></label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="buttonset">\n\t\t\t\t\t\t\t<button @click="doDelete()"><i class="mi-check"></i>{{settings.rb.filebrowser_delete}}</button>\n\t\t\t\t\t\t\t<button class="mura-secondary" @click="cancel()"><i class="mi-ban"></i>{{settings.rb.filebrowser_cancel}}</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t',data:function(){return{}},methods:{doDelete:function(){e.deleteFile(e.refresh,e.displayError),e.isDisplayWindow=""},cancel:function(){e.isDisplayWindow=""}},mounted:function(){e.isDisplayContext=0}}),Vue.component("editwindow",{props:["currentFile","settings"],template:'\n\t\t\t<div class="ui-dialog dialog-nobg actionwindow-formwrapper">\n\t\t\t\t<div class="block block-constrain">\n\t\t\t\t\t<div class="block-content">\n\t\t\t\t\t\t<div class="mura-header">\n\t\t\t\t\t\t\t<h1>{{settings.rb.filebrowser_editfile}}</h1>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="mura-control-group">\n\t\t\t\t\t\t\t<label>{{settings.rb.filebrowser_filename}}: <span>{{currentFile.name}}.{{currentFile.ext}}</span></label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<textarea id="contenteditfield" class="editwindow" v-model="filecontent"></textarea>\n\t\t\t\t\t\t<div class="buttonset">\n\t\t\t\t\t\t\t<button @click="updateContent()"><i class="mi-check"></i>{{settings.rb.filebrowser_update}}</button>\n\t\t\t\t\t\t\t<button class="mura-secondary" @click="cancel()"><i class="mi-ban"></i>{{settings.rb.filebrowser_cancel}}</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t',data:function(){return{filecontent:""}},methods:{updateContent:function(){e.updateContent(this.filecontent),e.isDisplayWindow=""},cancel:function(){e.isDisplayWindow=""},selectAll:function(){editor.commands.selectAll(this.editor)},autoFormat:function(){}},mounted:function(){this.filecontent=this.currentFile.content}}),Vue.component("appbar",{props:["links","isbottomnav","response","itemsper","location","showbar","displaymode","sortOn","sortDir","settings"],template:'\n\t\t\t\t<div :class="[showbar ? \'filewindow-appbar\' : \'filewindow-hideappbar\']">\n\t\t\t\t\t\t<modemenu :settings="settings" v-if="location" :displaymode="displaymode" :sortOn="sortOn" :sortDir="sortDir"></modemenu>\n\t\t\t\t\t\t<pagemenu :settings="settings" v-if="isbottomnav" :response="response"></pagemenu>\n\t\t\t\t\t\t<navmenu :settings="settings" :links="links" :response="response" :itemsper="itemsper"></navmenu>\n\t\t\t\t</div>\n\t\t\t',data:function(){return{}},computed:{},methods:{applyPage:function(t){var i=1;"last"==t?i=parseInt(e.response.totalpages):"next"==t?i=parseInt(e.response.pageindex)+1:"previous"==t&&(i=parseInt(e.response.pageindex)-1),this.$parent.refresh("",i)},applyItemsPer:function(){this.$parent.itemsper=this.itemsper}}}),Vue.component("modemenu",{props:["links","isbottomnav","response","itemsper","displaymode","sortDir","sortOn","settings"],template:'\n\t\t\t\t<div class="filewindow-modemenu">\n\t\t\t\t\t<div class="btn-group btn-group-toggle" data-toggle="buttons">\n\t\t\t\t\t\t<a class="btn btn-secondary" v-bind:class="{ highlight: viewmode == 1 }" @click="switchMode(1)">\n\t\t\t\t\t\t\t<i class="mi-th" :title="settings.rb.filebrowser_gridview"></i>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t\t<a class="btn btn-secondary" v-bind:class="{ highlight: viewmode == 2 }" @click="switchMode(2)">\n\t\t\t\t\t\t\t<i class="mi-bars" :title="settings.rb.filebrowser_listview"></i>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</div>\n\t\t\t\t\t<a @click="newFolder" class="btn btn-secondary btn-new-folder">\n\t\t\t\t\t\t<i class="mi-folder-open" :title="settings.rb.filebrowser_addfolder"></i>\n\t\t\t\t\t</a>\n\t\t\t\t\t<input class="filebrowser-filter" :placeholder="settings.rb.filebrowser_search" v-model="filterResults" v-on:input="filterChange">\n\t\t\t\t\t<label :title="settings.rb.filebrowser_includesubfolders" id="filebrowser-filter-switch" class="css-input switch switch-sm switch-primary inline"><input type="checkbox" value="1" name="filebrowser-filter-depth" v-model="filterDepth" v-on:change="filterChange"><span></span><span class="subfolders-label" id="filebrowser-filter-switch-label">{{settings.rb.filebrowser_includesubfolders}}</span></label>\n\t\t\t\t\x3c!--\t<div class="filebrowser-grid-sorting" v-if="displaymode == 1">\n\t\t\t\t\t\t<select name="sortOn" v-model="sortOn" @change="sortChange" class="itemsper">\n\t\t\t\t\t\t\t<option value="name">{{settings.rb.filebrowser_name}}</option>\n\t\t\t\t\t\t\t<option value="size">{{settings.rb.filebrowser_size}}</option>\n\t\t\t\t\t\t\t<option value="modified">{{settings.rb.filebrowser_modified}}</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t\t<select name="sortDir" v-model="sortDir" @change="sortChange" class="itemsper">\n\t\t\t\t\t\t\t<option value="ASC">&#9660;</option>\n\t\t\t\t\t\t\t<option value="DESC">&#9650;</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div> --\x3e\n\t\t\t\t </div>\n\t\t\t',data:function(){return{viewmode:this.$root.displaymode,filterResults:"",filterDepth:0,timeout:void 0}},methods:{switchMode:function(t){var e={displaymode:JSON.parse(JSON.stringify(t))};Mura.createCookie("mura_fbdisplaymode",JSON.stringify(e),1e3),this.$root.displaymode=this.viewmode=t},newFolder:function(){e.isDisplayWindow="ADDFOLDER"},sortChange:function(){var t={sortDir:this.sortDir,sortOn:this.sortOn};Mura.createCookie("mura_fbsort",JSON.stringify(t),1e3),this.$root.sortOn=this.sortOn,this.$root.sortDir=this.sortDir,this.$root.refresh()},filterChange:function(t,e){"change"==t.type?(this.$root.filterResults=this.filterResults,this.$root.filterDepth=this.filterDepth,""!=this.$root.filterResults&&(window.clearTimeout(this.timeout),this.timeout=window.setTimeout(this.$root.refresh,1))):(this.timeout&&window.clearTimeout(this.timeout),this.$root.filterResults=this.filterResults,this.$root.filterDepth=this.filterDepth,this.timeout=window.setTimeout(this.$root.refresh,500))}}}),Vue.component("pagemenu",{props:["links","isbottomnav","response","itemsper","settings"],template:'\n\t\t\t\t<div v-if="response.totalpages" class="filewindow-pageindex">\n\t\t\t\t\t{{settings.rb.filebrowser_page}} {{response.pageindex}} {{settings.rb.filebrowser_of}} {{response.totalpages}}\n\t\t\t\t</div>\n\t\t\t',mounted:function(){},methods:{}}),Vue.component("navmenu",{props:["links","isbottomnav","response","itemsper","settings"],template:'\n\t\t\t\t<div class="filewindow-navmenu">\n\t\t\t\t\t<ul class="pagination" v-if="response.totalitems>=10">\n\t\t\t\t\t\t<li class="paging" v-if="links && (links.previous || links.next)">\n\t\t\t\t\t\t\t<a href="#" v-if="links.first" @click.prevent="applyPage(\'first\')">\n\t\t\t\t\t\t\t\t<i class="mi-angle-double-left"></i>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t<a v-else class="disabled">\n\t\t\t\t\t\t\t\t<i class="mi-angle-double-left"></i>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class="paging" v-if="links && (links.previous || links.next)">\n\t\t\t\t\t\t\t<a href="#" v-if="links.previous" @click.prevent="applyPage(\'previous\')">\n\t\t\t\t\t\t\t\t<i class="mi-angle-left"></i>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t<a v-else class="disabled">\n\t\t\t\t\t\t\t\t<i class="mi-angle-left"></i>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class="paging" v-if="links && (links.previous || links.next)">\n\t\t\t\t\t\t\t<a href="#" v-if="links.next" @click.prevent="applyPage(\'next\')">\n\t\t\t\t\t\t\t\t<i class="mi-angle-right"></i>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t<a v-else class="disabled">\n\t\t\t\t\t\t\t\t<i class="mi-angle-right"></i>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class="paging paging-last" v-if="links && (links.previous || links.next)">\n\t\t\t\t\t\t\t<a href="#" v-if="links.last" @click.prevent="applyPage(\'last\')">\n\t\t\t\t\t\t\t\t<i class="mi-angle-double-right"></i>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t<a v-else class="disabled">\n\t\t\t\t\t\t\t\t<i class="mi-angle-double-right"></i>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</li>\n\t\n\t\t\t\t\t\t<li><label class="itemsper-label">{{settings.rb.filebrowser_perpage}} </label></li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<select class="itemsper" @change="applyItemsPer" v-model="itemsper">\n\t\t\t\t\t\t\t\t<option value=\'25\' :selected="itemsper == 25 ? \'selected\' : null">25</option>\n\t\t\t\t\t\t\t\t<option value=\'50\' :selected="itemsper == 50 ? \'selected\' : null">50</option>\n\t\t\t\t\t\t\t\t<option value=\'100\' :selected="itemsper == 100 ? \'selected\' : null">100</option>\n\t\t\t\t\t\t\t\t<option value=\'9999\' :selected="itemsper == 9999 ? \'selected\' : null">All</option>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</li>\n\t\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t',data:function(){var t=document.getElementsByClassName("itemsper");return t.length>0&&"25"!==t[0].value&&(this.$root.itemsper=parseInt(t[0].value),this.$root.refresh()),{}},mounted:function(){},methods:{applyPage:function(t){var i=1;"last"==t?i=parseInt(e.response.totalpages):"next"==t?i=parseInt(e.response.pageindex)+1:"previous"==t&&(i=parseInt(e.response.pageindex)-1),this.$root.refresh("",i)},applyItemsPer:function(){this.$root.itemsper=this.itemsper,this.$root.refresh()}}}),Vue.component("listmode",{props:["files","folders","foldertree","currentFile","settings"],template:'\n\t\t\t\t<div class="listmode-wrapper">\n\t\t\t\t\t<table class="mura-table-grid">\n\t\t\t\t\t\t<thead>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<th class="actions">\n\t\t\t\t\t\t\t\t\t<a v-if="foldertree.length" class="folder-back" href="#" @click.prevent="back()">\n\t\t\t\t\t\t\t\t\t\t&nbsp;\n\t\t\t\t\t\t\t\t\t\t<i class="mi-arrow-circle-o-left"></i>\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t\t<th class="var-width sort-grey"><a :class="sorton_name" @click.prevent="sortOn(\'name\')">{{settings.rb.filebrowser_filename}}</a></th>\n\t\t\t\t\t\t\t\t<th class="sort-grey"><a :class="sorton_size" @click.prevent="sortOn(\'size\')">{{settings.rb.filebrowser_size}}</a></th>\n\t\t\t\t\t\t\t\t<th class="sort-grey"><a :class="sorton_modified" @click.prevent="sortOn(\'modified\')">{{settings.rb.filebrowser_modified}}</a></th>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</thead>\n\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t\t<tr v-if="files.length==0">\n\t\t\t\t\t\t\t\t<td class="actions"></td>\n\t\t\t\t\t\t\t\t<td class="var-width">{{settings.rb.filebrowser_noresults}}</td>\n\t\t\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t<tr v-for="(file,index) in files">\n\t\t\t\t\t\t\t\t<td class="actions">\n\t\t\t\t\t\t\t\t\t<a href="#" :id="\'fileitem-\'+index" class="show-actions" @click.prevent="openMenu($event,file,index)"><i class="mi-ellipsis-v"></i></a>\n\t\t\t\t\t\t\t\t\t<div class="actions-menu hide">\n\t\t\t\t\t\t\t\t\t\t<ul class="actions-list">\n\t\t\t\t\t\t\t\t\t\t\t<li class="edit"><a @contextmenu="openMenu($event,file,index)"><i class="mi-pencil"></i>{{settings.rb.filebrowser_view}}</a></li>\n\t\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td class="var-width">\n\t\t\t\t\t\t\t\t\t<a v-if="parseInt(file.isfile)" href="#" @click.prevent="viewFile(file,index)"><i v-if="parseInt(file.isimage)" class="mi-picture"></i><i v-else class="mi-file"></i> {{file.fullname}}</a>\n\t\t\t\t\t\t\t\t\t<a v-else href="#" @click.prevent="refresh(file.name)"><i class="mi-folder"></i> {{file.fullname}}</a>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t<div v-if="parseInt(file.isfile)">\n\t\t\t\t\t\t\t\t\t\t{{file.size}}kb\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div v-else>\n\t\t\t\t\t\t\t\t\t\t--\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t{{file.lastmodifiedshort}}\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\n\t\t\t\t\t\t</tbody>\n\t\t\t\t\t</table>\n\t\t\t\t</div>',data:function(){return{menux:0,menuy:0,sorton_name:"",sorton_size:"",sorton_modified:""}},mounted:function(){this.setSortClass()},methods:{refresh:function(t,e){this.$root.refresh(t,e)},displayError:function(t){this.$root.displayError(t)},sortOn:function(t){var e=Mura.readCookie("mura_fbsort"),i={};e?(i=JSON.parse(e)).sortOn==t&&(i.sortDir&&"ASC"==i.sortDir?i.sortDir="DESC":i.sortDir="ASC"):i.sortDir="DESC";i.sortOn=t,this.$root.sortOn=i.sortOn,this.$root.sortDir=i.sortDir,Mura.createCookie("mura_fbsort",JSON.stringify(i),1e3),this.setSortClass(),this.$root.refresh()},setSortClass:function(){var t=Mura.readCookie("mura_fbsort"),e={};if(this.sorton_name="",this.sorton_size="",this.sorton_modified="",t)switch((e=JSON.parse(t)).sortOn){case"size":this.sorton_size="sorted-highlight-"+e.sortDir.toLowerCase();break;case"modified":this.sorton_modified="sorted-highlight-"+e.sortDir.toLowerCase();break;default:this.sorton_name="sorted-highlight-"+e.sortDir.toLowerCase()}},back:function(){this.$root.back()},viewFile:function(t,i){this.$root.currentFile=t,this.$root.currentIndex=i,this.checkImageType(t,i)?e.isDisplayWindow="VIEW":this.checkFileEditable(t,i)&&e.editFile(this.successEditFile)},successEditFile:function(t){this.currentFile.content=t.data.content,e.isDisplayWindow="EDIT"},isViewable:function(t,i){return this.$root.currentFile=t,this.$root.currentIndex=i,e.isViewable()},checkFileEditable:function(t,i){return this.$root.currentFile=t,this.$root.currentIndex=i,e.checkFileEditable()},checkImageType:function(t,i){return this.$root.currentFile=t,this.$root.currentIndex=i,e.checkImageType()},checkIsFile:function(){return e.checkIsFile()},openMenu:function(t,e,i,n){void 0!==window.tr&&(window.tr.className=""),window.index=i,window.gridMode=!1,this.$root.isDisplayContext=0;var s=33,r=10;document.getElementById("MuraFileBrowserContainer")&&document.getElementById("MuraFileBrowserContainer").parentNode==document.getElementById("alertDialogMessage")&&(r+=70,s+=Math.floor(document.getElementById("MuraFileBrowserContainer").getBoundingClientRect().left));var o=Math.floor(document.getElementById("fileitem-"+i).getBoundingClientRect().left)-s,l=Math.floor(document.getElementById("fileitem-"+i).getBoundingClientRect().top)-r;this.$root.isDisplayWindow="",this.$root.currentFile=e,this.$root.currentFile.index=i,this.$root.currentIndex=i,this.menux=o,this.menuy=l,this.$emit("doDisplayContext",{menux:this.menux,menuy:this.menuy,display:1}),t.preventDefault()}}}),Vue.component("gridmode",{props:["files","folders","foldertree","isDisplayContext","currentFile"],template:'\n\t\t\t\t<div class="gridmode-wrapper">\n\t\t\t\t\t<div v-if="foldertree.length" class="fileviewer-back fileviewer-item" @click="back()">\n\t\t\t\t\t\t<div class="fileviewer-item-icon">\n\t\t\t\t\t\t\t<i class="mi-arrow-circle-o-left"></i>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-for="(file,index) in files">\n\t\t\t\t\t\t\x3c!-- files --\x3e\n\t\t\t\t\t\t<div class="fileviewer-item" v-if="parseInt(file.isfile)">\n\t\t\t\t\t\t\t<div class="fileviewer-item-image">\n\t\t\t\t\t\t\t\t\x3c!-- image --\x3e\n\t\t\t\t\t\t\t\t<div v-if="parseInt(file.isimage)" class="fileviewer-item-icon" :style="{ \'background-image\': \'url(\' + encodeURI(file.url) + \'?\' + Math.ceil(Math.random()*100000) + \')\' }" @click.prevent="viewFile(file,index)"></div>\n\t\t\t\t\t\t\t\t\x3c!-- file with icon --\x3e\n\t\t\t\t\t\t\t\t<div v-else class="fileviewer-item-icon" :class="[\'fileviewer-item-icon-\' + file.type]" @click="openMenu($event,file,index)">\n\t\t\t\t\t\t\t\t\t<i class="mi-file"></i>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="fileviewer-item-meta" @click="openMenu($event,file,index)">\n\t\t\t\t\t\t\t\t<div class="fileviewer-item-label">\n\t\t\t\t\t\t\t\t\t{{file.fullname}}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="fileviewer-item-meta-details">\n\t\t\t\t\t\t\t\t\t<div v-if="parseInt(file.isfile)" class="fileviewer-item-meta-size">\n\t\t\t\t\t\t\t\t\t\t{{file.size}}kb\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="fileviewer-item-meta-date">\n\t\t\t\t\t\t\t\t\t\t{{file.lastmodifiedshort}}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="fileviewer-item-actions">\n\t\t\t\t\t\t\t\t\t<a href="#" :key="\'fileitem-\'+index" :id="\'fileitem-\'+index" class="show-actions" @click.stop="openMenu($event,file,index)"><i class="mi-ellipsis-v"></i></a>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\x3c!-- folders --\x3e\n\t\t\t\t\t\t<div class="fileviewer-item" v-else>\n\t\t\t\t\t\t\t<div class="fileviewer-item-icon" @click="refresh(file.name)">\n\t\t\t\t\t\t\t\t<i class="mi-folder-open"></i>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="fileviewer-item-meta">\n\t\t\t\t\t\t\t\t<div class="fileviewer-item-label">\n\t\t\t\t\t\t\t\t\t{{file.fullname}}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="fileviewer-item-meta-details">\n\t\t\t\t\t\t\t\t\t<div v-if="parseInt(file.isfile)" class="fileviewer-item-meta-size">\n\t\t\t\t\t\t\t\t\t\t{{file.size}}kb\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="fileviewer-item-actions">\n\t\t\t\t\t\t\t\t\t<a href="#" :id="\'fileitem-\'+index" class="show-actions" @click.stop.prevent="openMenu($event,file,index)"><i class="mi-ellipsis-v"></i></a>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="clearfix"></div>\n\t\t\t\t</div>',data:function(){return{menux:0,menuy:0,offsetx:0,offsety:0}},mounted:function(){},methods:{refresh:function(t,e){this.$root.refresh(t,e)},back:function(){this.$root.back()},viewFile:function(t,i){this.$root.currentFile=t,this.$root.currentIndex=i,this.checkImageType(t,i)?e.isDisplayWindow="VIEW":this.checkFileEditable(t,i)&&e.editFile(this.successEditFile)},checkFileEditable:function(t,i){return this.$root.currentFile=t,this.$root.currentIndex=i,e.checkFileEditable()},checkImageType:function(t,i){return this.$root.currentFile=t,this.$root.currentIndex=i,e.checkImageType()},checkIsFile:function(){return e.checkIsFile()},successEditFile:function(t){this.currentFile.content=t.data.content,e.isDisplayWindow="EDIT"},openMenu:function(t,e,i){window.gridMode=!0,window.index=i,t.preventDefault();var n=0,s=10;document.getElementById("MuraFileBrowserContainer")&&document.getElementById("MuraFileBrowserContainer").parentNode==document.getElementById("alertDialogMessage")&&(s+=70,n+=Math.floor(document.getElementById("MuraFileBrowserContainer").getBoundingClientRect().left)),this.menux=Math.floor(document.getElementById("fileitem-"+i).getBoundingClientRect().left)-28-n,this.menuy=Math.floor(document.getElementById("fileitem-"+i).getBoundingClientRect().top)-s,this.$root.currentFile=e,this.$root.currentIndex=i,this.$emit("doDisplayContext",{menux:this.menux,menuy:this.menuy,display:1}),this.$root.isDisplayWindow="",this.$root.currentFile=e,this.$root.currentFile.index=i,this.$root.currentIndex=i,this.$root.isDisplayContext=0,this.$nextTick((function(){this.$root.isDisplayContext=1})),this.$root.isDisplayWindow="",this.$root.currentFile=e,this.$root.currentFile.index=i,this.$root.currentIndex=i,t.preventDefault()}}}),Vue.component("filewindow",{props:["files","folders","foldertree","currentFile","settings","displaymode"],template:'\n\t\t\t\t<div class="filewindow-wrapper" id="mura-filewindow-wrapper">\n\t\t\t\t\t<gridmode v-on:doDisplayContext="displayContext" v-if="displaymode==1" :settings="settings" :currentFile="currentFile" :foldertree="foldertree" :files="files" :folders="folders"></gridmode>\n\t\t\t\t\t<listmode v-on:doDisplayContext="displayContext" v-if="displaymode==2" :settings="settings" :currentFile="currentFile" :foldertree="foldertree" :files="files" :folders="folders"></listmode>\n\t\t\t\t\t<contextmenu :settings="settings" v-click-outside="hideContext" :currentFile="this.$parent.currentFile" :menux="menux" :menuy="menuy" v-if="isDisplay"></contextmenu>\n\t\t\t\t</div>',data:function(){return{menux:0,menuy:0,isDisplay:0}},methods:{displayContext:function(t){this.menux=t.menux,this.menuy=t.menuy,this.isDisplay&&1!=t.display?this.isDisplay=0:this.isDisplay=1},hideContext:function(){this.isDisplay=0}}}),Vue.component("spinner",{template:'\n\t\t\t\t<div id="spinner">\n\t\n\t\t\t\t</div>',data:function(){return{}},mounted:function(){$("#spinner")&&$("#spinner").spin(spinnerArgs),$(".ui-dialog-title").length&&$(".mura-modal-only").remove()},destroyed:function(){$("#spinner").spin(!1)},methods:{}});var e=new Vue({el:"#"+t.target,template:'\n\t\t\t\t<div class="fileviewer-wrapper">\n\t\t\t\t\t<spinner v-if="spinnermodal"></spinner>\n\t\t\t\t\t{{message}}\n\t\t\t\t\t<gallerywindow v-if="isDisplayWindow==\'VIEW\'" :settings="settings" :currentFile="currentFile" :currentIndex="currentIndex"></gallerywindow>\n\t\t\t\t\t<imageeditwindow v-if="isDisplayWindow==\'EDITIMAGE\'" :settings="settings" :currentFile="currentFile" :currentIndex="currentIndex"></imageeditwindow>\n\t\t\t\t\t<actionwindow v-if="isDisplayWindow != \'\'" :foldertree="foldertree" :settings="settings" :isDisplayWindow="isDisplayWindow" :currentIndex="currentIndex" :currentFile="currentFile" :error="error"></actionwindow>\n\t\t\t\t\t<div class="mura-header">\n\t\t\t\t\t\t<h1 class="mura-modal-only">{{settings.rb.filebrowser_filemanager}}</h1>\n\t\t\t\t\t\t<ul class="breadcrumb">\n\t\t\t\t\t\t\t<li @click="setDirDepth(-1)"><a><i class="mi-home"></i>{{resourcepath}}</a></li>\n\t\t\t\t\t\t\t<li v-for="(item,index) in foldertree" @click="setDirDepth(index)"><a><i class="mi-folder-open"></i>{{item}}</a></li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="fileviewer-droptarget">\n\t\t\t\t\t\t<form enctype="multipart/form-data" novalidate v-if="isStart || isSave">\n\t\t\t\t\t\t\t<input type="file" multiple :name="uploadField" :disabled="isSave" @drop="filesDropped($event);" @change="filesChanged($event.target.name, $event.target.files);" accept="*.*" class="file-input-field">\n\t\t\t\t\t\t\t<p v-if="isStart" class="upload-icon"><i class="mi-upload"></i>\n\t\t\t\t\t\t\t\t{{settings.rb.filebrowser_draghere}}\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<p v-if="isSave" class="download-icon">\n\t\t\t\t\t\t\t\t{{settings.rb.filebrowser_uploading}} ({{fileCount}})\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t</form>\n\t\t\t\t\t</div>\n\t\t\t\t\t<appbar v-if="response.links" :showbar=1 :settings="settings" :location=1 :links="response.links" :itemsper="itemsper" :response="response" :displaymode="displaymode" :sortOn="sortOn" :sortDir="sortDir"></appbar>\n\t\t\t\t\t<filewindow :settings="settings" :currentFile="currentFile" :isDisplayContext="isDisplayContext" :foldertree="foldertree" :files="files" :folders="folders" :displaymode="displaymode"></filewindow>\n\t\t\t\t\t<appbar v-if="response.links" :showbar=showfooter :settings="settings" :location=0 :links="response.links" :itemsper="itemsper" :response="response" :isbottomnav="true" :sortOn="sortOn" :sortDir="sortDir"></appbar>\n\t\t\t\t</div>',data:{currentView:"fileviewer",currentState:null,currentFile:null,currentIndex:0,currentUser:null,isAdmin:null,foldertree:[],fileCount:0,files:[],folders:[],groups:[],spinnermodal:0,error:"",showfooter:0,settings:{rb:{}},displaymode:this.config.displaymode,uploadedFiles:[],isDisplayContext:0,isDisplayWindow:"",uploadField:"uploadFiles",filterResults:"",filterDepth:0,sortOn:"name",sortDir:"DESC",itemsper:25,message:"",editfilelist:t.editfilelist,resourcepath:this.config.resourcepath.replace("_"," "),response:{pageindex:0}},ready:function(){},computed:{isStart:function(){return 0===this.currentState},isSave:function(){return 1===this.currentState},isSuccess:function(){return 2===this.currentState},isonError:function(){return 3===this.currentState}},methods:{updateDelete:function(){t.updateDelete(currentFile)},updateContent:function(e){for(var i="",n=0;n<this.foldertree.length;n++)i=i+"/"+this.foldertree[n];t.doUpdateContent(i,this.currentFile,e,this.refresh)},renameFile:function(){var e="";e+=this.currentFile.subfolder,t.doRenameFile(e,this.currentFile,this.refresh)},newFolder:function(e){for(var i="",n=0;n<this.foldertree.length;n++)i=i+"/"+this.foldertree[n];t.doNewFolder(i,e,this.refresh)},updateEdit:function(){t.updateEdit(currentFile)},displayResults:function(t){this.response=t.data,this.files=t.data.items,this.folders=t.data.folders,t.data.settings&&(this.settings=t.data.settings),this.$nextTick((function(){this.spinnermodal=0})),this.showfooter=this.response.totalpages-1},displayError:function(t){t.message&&(this.message=message)},previousFile:function(t){if(t=t||0,index=this.currentIndex,index--,!(index+1<=0)&&parseInt(this.files[index].isfile))if(t&&this.checkImageType()||!t){if(this.currentFile=this.files[index],this.currentIndex=index,"svg"!=this.currentFile.ext.toLowerCase()&&void 0===e.currentFile.info.width){for(var i="",n=0;n<this.foldertree.length;n++)i=i+"/"+this.foldertree[n];Mura.getEntity("filebrowser").invoke("getImageInfo",{directory:i,subfolder:e.currentFile.subfolder,resourcepath:MuraFileBrowser.config.resourcepath,filename:e.currentFile.fullname}).then((function(t){e.currentFile.info=t}))}}else this.previousFile(t)},nextFile:function(t){if(t=t||0,index=this.currentIndex,index++,!(index>=this.files.length))if(t&&this.checkImageType()||!t){if(this.currentFile=this.files[index],"svg"!=this.currentFile.ext.toLowerCase()&&void 0===e.currentFile.info.width){for(var i="",n=0;n<this.foldertree.length;n++)i=i+"/"+this.foldertree[n];e.currentFile.url.match(/.*\//i);Mura.getEntity("filebrowser").invoke("getImageInfo",{directory:i,subfolder:e.currentFile.subfolder,resourcepath:MuraFileBrowser.config.resourcepath,filename:e.currentFile.fullname}).then((function(t){e.currentFile.info=t}))}this.currentIndex=index}else this.nextFile(t)},upload:function(){},uploadReset:function(){this.currentState=0,this.uploadedFiles=[];var t=document.querySelector('input[type="file"][name="uploadFiles"]');t&&(t.value=[]),this.error=null},setDirDepth:function(t){this.foldertree=this.foldertree.slice(0,t+1),this.refresh()},editFile:function(e,i){for(var n="",s=0;s<this.foldertree.length;s++)n=n+"/"+this.foldertree[s];t.getEditFile(n,this.currentFile,e)},viewFile:function(t){},deleteFile:function(e,i){var n="";n+=this.currentFile.subfolder,t.doDeleteFile(n,this.currentFile,e,i)},duplicateFile:function(e,i){var n="";this.isDisplayWindow="",n+=this.currentFile.subfolder,t.doDuplicateFile(n,this.currentFile,e,i)},refresh:function(e,i,n){n?(this.isDisplayWindow="",this.$nextTick((function(){this.$root.isDisplayWindow=n}))):this.isDisplayWindow="",e&&e.length&&this.foldertree.push(e);var s="";isNaN(i);for(var r=0;r<this.foldertree.length;r++)s=s+"/"+this.foldertree[r];this.isDisplayContext="",this.spinnermodal=1;var o={siteid:Mura.siteid,foldertree:JSON.parse(JSON.stringify(this.foldertree)),itemsper:this.itemsper,resourcepath:MuraFileBrowser.config.resourcepath,sortDir:this.sortDir,sortOn:this.sortOn};window.sessionStorage.setItem("mura_fbfolder",JSON.stringify(o)),t.loadDirectory(s,i,this.displayResults,this.displayError,this.filterResults,this.filterDepth,this.sortOn,this.sortDir,this.itemsper,n)},back:function(){this.foldertree.splice(-1);this.foldertree.length||this.foldertree[this.foldertree.length-1];this.refresh()},closeMenu:function(t){this.isDisplayContext=0,t.preventDefault()},filesDropped:function(t){t.preventDefault();var e=t.target.name,i=t.dataTransfer.files;this.uploadedFiles=i;var n=new FormData,s="";if(i.length){this.fileCount=i.length,Array.from(Array(i.length).keys()).map((function(t){n.append(e,i[t],i[t].name)}));for(var r=0;r<this.foldertree.length;r++)s=s+"/"+this.foldertree[r];n.append("directory",s),this.save(n)}},filesChanged:function(t,e){this.uploadedFiles=e;var i=new FormData,n="";if(e.length){this.fileCount=e.length,Array.from(Array(e.length).keys()).map((function(n){i.append(t,e[n],e[n].name)}));for(var s=0;s<this.foldertree.length;s++)n=n+"/"+this.foldertree[s];i.append("directory",n),this.save(i)}},save:function(e){this.currentState=1,t.doUpload(e,this.saveComplete)},saveComplete:function(){this.uploadReset(),this.refresh()},checkSelectMode:function(){return MuraFileBrowser.config.selectMode},isViewable:function(){for(var t=this.settings.editfilelist,e=this.settings.imagelist,i=0;i<t.length;i++)if(this.currentFile.ext.toLowerCase()==t[i])return!0;for(i=0;i<e.length;i++)if(this.currentFile.ext.toLowerCase()==e[i])return!0;return!1},checkFileEditable:function(){for(var t=this.settings.editfilelist,e=0;e<t.length;e++)if(this.currentFile.ext.toLowerCase()==t[e])return!0;return!1},checkImageType:function(){for(var t=this.settings.imagelist,e=0;e<t.length;e++)if(this.currentFile.ext.toLowerCase()==t[e])return!0;return!1},checkIsUserArea:function(){return"Application_Root"!=t.config.resourcepath},checkIsFile:function(){return!!Math.floor(this.currentFile.isfile)}},mounted:function(){this.uploadReset(),this.$nextTick((function(){this.spinnermodal=1})),this.selectMode=t.config.selectMode;var e=this;Mura.getCurrentUser().then((function(t){e.currentUser=t,t.isSuperUser()&&(e.isAdmin=!0)}),(function(t){sAdmin=!1}));var i="",n=window.sessionStorage.getItem("mura_fbfolder");if(n)try{var s=JSON.parse(n);if(s.itemsper&&(this.itemsper=s.itemsper),s.resourcepath!=t.config.resourcepath||s.siteid!=mura.siteid){var r={siteid:Mura.siteid,foldertree:[],itemsper:this.itemsper,sortDir:this.sortDir,sortOn:this.sortOn,resourcepath:t.config.resourcepath};window.sessionStorage.setItem("fbFolderTree",JSON.stringify(r),1)}else if(s.foldertree){this.$root.foldertree=s.foldertree;for(var o=0;o<this.foldertree.length;o++)i=i+"/"+this.foldertree[o]}}catch(t){console.log("error reading storage json:"+s),window.sessionStorage.setItem("fbFolderTree","",1)}var l=Mura.readCookie("mura_fbdisplaymode");if(l){var a=JSON.parse(l);a.displaymode&&(this.$root.displaymode=this.viewmode=a.displaymode)}t.loadBaseDirectory(this.displayResults,this.displayError,i),window.addEventListener("mouseup",(function(t){}))}})}}}});